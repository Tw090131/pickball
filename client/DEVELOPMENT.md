# 开发文档

## 已完成功能

### ✅ 第一阶段核心功能

#### 1. 首页 & 赛事发现
- [x] 赛事列表展示
- [x] 按分类筛选（比赛/活动/俱乐部）
- [x] 按时间/距离排序
- [x] 状态标签显示（报名中/比赛中/已结束）
- [x] 距离计算和显示

#### 2. 赛事发布系统
- [x] 活动基本信息设置
- [x] 时间信息设置（开始/结束/截止时间）
- [x] 赛制设置（单打/双打/混双）
- [x] 轮转规则（八人转/五人转/淘汰赛/分组循环）
- [x] 计分制设置（11分/21分/31分）
- [x] 报名管理（人数限制/报名费）

#### 3. 报名与参与
- [x] 微信登录授权
- [x] 手机号授权
- [x] 组队方式选择（自带搭档/随机匹配）
- [x] 支付接口预留（需要后端支持）

#### 4. 实时计分与成绩看板
- [x] 现场计分板（实时录入比分）
- [x] 比赛列表管理
- [x] 实时排名（胜场/净胜分）
- [x] 晋级图（淘汰赛对阵树状图）
- [x] 比分录入和自动判断胜负

## 技术实现

### 页面结构
- 8个主要页面，覆盖所有核心功能
- 统一的样式设计，使用主题色 #4CAF50
- 响应式布局，适配不同屏幕

### 数据管理
- 使用 `app.globalData` 临时存储
- 模拟数据（Mock Data）用于演示
- API 接口已预留，待后端开发

### 工具函数
- 时间格式化
- 距离计算
- 防抖/节流
- HTTP 请求封装

## 待开发功能

### 后端集成
1. **数据库设计**
   - 用户表
   - 赛事表
   - 报名表
   - 比赛表
   - 比分表
   - 排名表

2. **API 开发**
   - 用户认证 API
   - 赛事 CRUD API
   - 报名管理 API
   - 计分 API
   - 排名计算 API
   - 支付 API

3. **微信服务**
   - 微信登录
   - 微信支付
   - 模板消息
   - 订阅消息

### 功能增强
1. **搜索功能**
   - 关键词搜索
   - 高级筛选

2. **地图功能**
   - 地图选点
   - 导航功能

3. **消息通知**
   - 报名成功通知
   - 比赛开始提醒
   - 成绩发布通知

4. **社交功能**
   - 分享到微信
   - 邀请好友
   - 评论功能

5. **数据统计**
   - 个人战绩
   - 赛事统计
   - 排行榜历史

## 开发建议

### 1. 后端开发
建议使用以下技术栈：
- Node.js + Express / Python + Django / Java + Spring Boot
- MySQL / PostgreSQL 数据库
- Redis 缓存
- 微信小程序 SDK

### 2. 数据库设计要点
- 赛事表需要存储位置信息（经纬度）
- 报名表需要关联用户和赛事
- 比赛表需要支持不同赛制
- 比分表需要记录详细比分信息

### 3. 支付流程
1. 用户点击支付
2. 前端调用后端创建订单
3. 后端调用微信支付统一下单
4. 前端调用 wx.requestPayment
5. 支付成功后更新报名状态
6. 支持退款功能（截止时间前）

### 4. 排名算法
- 按胜场数排序
- 胜场相同时按净胜分排序
- 支持不同轮转规则的排名计算

### 5. 性能优化
- 列表分页加载
- 图片懒加载
- 数据缓存
- 接口防抖

## 测试建议

### 功能测试
- [ ] 赛事发布流程
- [ ] 报名流程
- [ ] 支付流程
- [ ] 计分功能
- [ ] 排名计算
- [ ] 晋级图生成

### 兼容性测试
- [ ] 不同版本微信
- [ ] 不同屏幕尺寸
- [ ] iOS / Android

### 性能测试
- [ ] 列表加载性能
- [ ] 图片加载性能
- [ ] 接口响应时间

## 部署说明

### 小程序发布
1. 在微信公众平台配置服务器域名
2. 上传代码
3. 提交审核
4. 发布上线

### 服务器部署
1. 配置 HTTPS 证书
2. 配置域名
3. 部署后端服务
4. 配置数据库
5. 配置微信支付

## 注意事项

1. **AppID 配置**：需要在 `project.config.json` 中配置真实的小程序 AppID
2. **服务器域名**：需要在微信公众平台配置服务器域名白名单
3. **支付功能**：需要企业认证的小程序才能使用微信支付
4. **位置权限**：需要用户授权位置信息
5. **图片资源**：需要准备 TabBar 图标和默认头像

## 后续规划

### 第二阶段功能
- 俱乐部管理
- 教练预约
- 场地预订
- 装备商城

### 第三阶段功能
- 视频教学
- 赛事直播
- 社区功能
- 数据分析

