<!--pages/event-detail/event-detail.wxml-->
<view class="container">
  <view class="event-header card">
    <view class="header-top">
      <view class="event-title">{{event.title}}</view>
      <view class="status-tag {{event.statusClass}}">{{event.status}}</view>
    </view>
    <view class="organizer">ä¸»åŠæ–¹ï¼š{{event.organizer}}</view>
  </view>

  <view class="event-info card">
    <view class="info-section">
      <view class="section-title">ğŸ“… æ—¶é—´ä¿¡æ¯</view>
      <view class="info-row">
        <text class="label">å¼€å§‹æ—¶é—´ï¼š</text>
        <text>{{event.startTime}}</text>
      </view>
      <view class="info-row">
        <text class="label">ç»“æŸæ—¶é—´ï¼š</text>
        <text>{{event.endTime}}</text>
      </view>
      <view class="info-row">
        <text class="label">æŠ¥åæˆªæ­¢ï¼š</text>
        <text>{{event.registrationDeadline}}</text>
      </view>
    </view>

    <view class="info-section">
      <view class="section-title">ğŸ“ åœ°ç‚¹ä¿¡æ¯</view>
      <view class="info-row">
        <text>{{event.location}}</text>
        <text class="distance" wx:if="{{event.distance}}">{{event.distance}}km</text>
      </view>
    </view>

    <view class="info-section">
      <view class="section-title">ğŸ† èµ›åˆ¶ä¿¡æ¯</view>
      <view class="info-row">
        <text class="label">æ¯”èµ›å½¢å¼ï¼š</text>
        <text>{{event.format}}</text>
      </view>
      <view class="info-row">
        <text class="label">è½®è½¬è§„åˆ™ï¼š</text>
        <text>{{event.rotationRule}}</text>
      </view>
      <view class="info-row">
        <text class="label">è®¡åˆ†åˆ¶ï¼š</text>
        <text>{{event.scoringSystem}}åˆ†åˆ¶</text>
      </view>
    </view>

    <view class="info-section">
      <view class="section-title">ğŸ‘¥ æŠ¥åä¿¡æ¯</view>
      <view class="info-row">
        <text class="label">æŠ¥åäººæ•°ï¼š</text>
        <text>{{event.currentParticipants}}/{{event.maxParticipants}}äºº</text>
      </view>
      <view class="info-row">
        <text class="label">æŠ¥åè´¹ï¼š</text>
        <text class="fee" wx:if="{{event.registrationFee > 0}}">Â¥{{event.registrationFee}}</text>
        <text wx:else>å…è´¹</text>
      </view>
    </view>

    <view class="info-section" wx:if="{{event.description}}">
      <view class="section-title">ğŸ“ æ´»åŠ¨è¯´æ˜</view>
      <view class="description">{{event.description}}</view>
    </view>
  </view>

  <!-- å·²æŠ¥ååˆ—è¡¨ -->
  <view class="participants card" wx:if="{{participants.length > 0}}">
    <view class="section-title">å·²æŠ¥åäººå‘˜</view>
    <view class="participant-list">
      <view class="participant-item" wx:for="{{participants}}" wx:key="id">
        <image class="avatar" src="{{item.avatarUrl}}" mode="aspectFill"></image>
        <text class="name">{{item.nickName}}</text>
        <text class="partner" wx:if="{{item.partnerName}}">æ­æ¡£ï¼š{{item.partnerName}}</text>
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <button 
      class="btn-primary action-btn"
      wx:if="{{event.status === 'æŠ¥åä¸­' && !isRegistered}}"
      bindtap="goToRegister"
    >
      ç«‹å³æŠ¥å
    </button>
    <button 
      class="btn-secondary action-btn"
      wx:if="{{event.status === 'æŠ¥åä¸­' && isRegistered}}"
      disabled
    >
      å·²æŠ¥å
    </button>
    <button 
      class="btn-primary action-btn"
      wx:if="{{event.status === 'æ¯”èµ›ä¸­'}}"
      bindtap="goToScoreboard"
    >
      è¿›å…¥è®¡åˆ†æ¿
    </button>
    <button 
      class="btn-primary action-btn"
      wx:if="{{event.status === 'æ¯”èµ›ä¸­' || event.status === 'å·²ç»“æŸ'}}"
      bindtap="goToRanking"
    >
      æŸ¥çœ‹æ’å
    </button>
    <button 
      class="btn-primary action-btn"
      wx:if="{{event.rotationRule === 'æ·˜æ±°èµ›' && (event.status === 'æ¯”èµ›ä¸­' || event.status === 'å·²ç»“æŸ')}}"
      bindtap="goToBracket"
    >
      æŸ¥çœ‹æ™‹çº§å›¾
    </button>
  </view>
</view>

