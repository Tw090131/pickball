<!--pages/create-event/create-event.wxml-->
<view class="container">
  <view class="form-container">
    <!-- åŸºæœ¬ä¿¡æ¯ -->
    <view class="form-section card">
      <view class="section-title">åŸºæœ¬ä¿¡æ¯</view>
      
      <view class="input-group">
        <text class="input-label">æ´»åŠ¨æ ‡é¢˜ *</text>
        <input 
          class="input-field" 
          placeholder="è¯·è¾“å…¥æ´»åŠ¨æ ‡é¢˜"
          value="{{formData.title}}"
          bindinput="onInput"
          data-field="title"
        />
      </view>

      <view class="input-group">
        <text class="input-label">æ´»åŠ¨åˆ†ç±» *</text>
        <picker 
          mode="selector" 
          range="{{categories}}"
          range-key="label"
          value="{{formData.categoryIndex}}"
          bindchange="onCategoryChange"
        >
          <view class="picker-view">
            {{categories[formData.categoryIndex].label}}
          </view>
        </picker>
      </view>

      <view class="input-group">
        <text class="input-label">æ´»åŠ¨åœ°ç‚¹ *</text>
        <view class="location-input">
          <input 
            class="input-field" 
            placeholder="è¯·è¾“å…¥æ´»åŠ¨åœ°ç‚¹æˆ–ç‚¹å‡»é€‰æ‹©"
            value="{{formData.location}}"
            bindinput="onInput"
            data-field="location"
          />
          <button class="btn-location" bindtap="chooseLocation">ğŸ“ é€‰æ‹©ä½ç½®</button>
        </view>
        <text class="input-hint" wx:if="{{formData.location}}">å·²é€‰æ‹©ï¼š{{formData.location}}</text>
      </view>
    </view>

    <!-- æ—¶é—´ä¿¡æ¯ -->
    <view class="form-section card">
      <view class="section-title">æ—¶é—´ä¿¡æ¯</view>
      
      <view class="input-group">
        <text class="input-label">å¼€å§‹æ—¶é—´ *</text>
        <picker 
          mode="multiSelector"
          value="{{startTimeIndex}}"
          range="{{timePickerRange}}"
          bindchange="onStartTimeChange"
        >
          <view class="picker-view">
            {{formData.startTime || 'è¯·é€‰æ‹©å¼€å§‹æ—¶é—´'}}
          </view>
        </picker>
      </view>

      <view class="input-group">
        <text class="input-label">ç»“æŸæ—¶é—´ *</text>
        <picker 
          mode="multiSelector"
          value="{{endTimeIndex}}"
          range="{{timePickerRange}}"
          bindchange="onEndTimeChange"
        >
          <view class="picker-view">
            {{formData.endTime || 'è¯·é€‰æ‹©ç»“æŸæ—¶é—´'}}
          </view>
        </picker>
      </view>

      <view class="input-group">
        <text class="input-label">æŠ¥åæˆªæ­¢æ—¶é—´ *</text>
        <picker 
          mode="multiSelector"
          value="{{deadlineIndex}}"
          range="{{timePickerRange}}"
          bindchange="onDeadlineChange"
        >
          <view class="picker-view">
            {{formData.registrationDeadline || 'è¯·é€‰æ‹©æŠ¥åæˆªæ­¢æ—¶é—´'}}
          </view>
        </picker>
      </view>
    </view>

    <!-- èµ›åˆ¶è®¾ç½® -->
    <view class="form-section card">
      <view class="section-title">èµ›åˆ¶è®¾ç½®</view>
      
      <view class="input-group">
        <text class="input-label">æ¯”èµ›å½¢å¼ *</text>
        <picker 
          mode="selector" 
          range="{{formats}}"
          value="{{formData.formatIndex}}"
          bindchange="onFormatChange"
        >
          <view class="picker-view">
            {{formats[formData.formatIndex]}}
          </view>
        </picker>
      </view>

      <view class="input-group">
        <text class="input-label">è½®è½¬è§„åˆ™ *</text>
        <picker 
          mode="selector" 
          range="{{rotationRules}}"
          value="{{formData.rotationRuleIndex}}"
          bindchange="onRotationRuleChange"
        >
          <view class="picker-view">
            {{rotationRules[formData.rotationRuleIndex]}}
          </view>
        </picker>
      </view>

      <view class="input-group">
        <text class="input-label">è®¡åˆ†åˆ¶ *</text>
        <picker 
          mode="selector" 
          range="{{scoringSystems}}"
          value="{{formData.scoringSystemIndex}}"
          bindchange="onScoringSystemChange"
        >
          <view class="picker-view">
            {{scoringSystems[formData.scoringSystemIndex]}}åˆ†åˆ¶
          </view>
        </picker>
      </view>
    </view>

    <!-- æŠ¥åè®¾ç½® -->
    <view class="form-section card">
      <view class="section-title">æŠ¥åè®¾ç½®</view>
      
      <view class="input-group">
        <text class="input-label">æœ€å¤§äººæ•° *</text>
        <input 
          class="input-field" 
          type="number"
          placeholder="{{minPlayers}}-{{maxPlayers}}äºº"
          value="{{formData.maxParticipants}}"
          bindinput="onInput"
          data-field="maxParticipants"
          min="{{minPlayers}}"
          max="{{maxPlayers}}"
        />
        <text class="input-hint" wx:if="{{rotationType === 'eight_rotation'}}">
          å…«äººè½¬æ”¯æŒ {{minPlayers}}-{{maxPlayers}} äººå‚ä¸
        </text>
      </view>

      <view class="input-group">
        <text class="input-label">æŠ¥åè´¹ç”¨</text>
        <picker 
          mode="selector" 
          range="{{feeModes}}"
          range-key="label"
          value="{{formData.feeModeIndex}}"
          bindchange="onFeeModeChange"
        >
          <view class="picker-view">
            {{feeModes[formData.feeModeIndex].label}}
          </view>
        </picker>
        <text class="input-hint">{{feeModes[formData.feeModeIndex].hint}}</text>
        
        <!-- å¦‚æœæ˜¯èµ›å‰æ”¶æ¬¾ï¼Œæ˜¾ç¤ºé‡‘é¢è¾“å…¥æ¡† -->
        <view class="input-group" wx:if="{{formData.feeModeIndex === 2}}" style="margin-top: 10px;">
          <text class="input-label">æ”¶æ¬¾é‡‘é¢ï¼ˆå…ƒï¼‰*</text>
          <input 
            class="input-field" 
            type="digit"
            placeholder="è¯·è¾“å…¥æ”¶æ¬¾é‡‘é¢"
            value="{{formData.registrationFee}}"
            bindinput="onInput"
            data-field="registrationFee"
          />
        </view>
      </view>

      <!-- å…«äººè½¬ç‰¹æ®Šè®¾ç½® -->
      <view class="rotation-settings" wx:if="{{rotationType === 'eight_rotation'}}">
        <view class="input-group">
          <view class="switch-group">
            <text class="input-label">å…è®¸æ›¿è¡¥</text>
            <switch 
              checked="{{allowSubstitute}}"
              bindchange="onSubstituteChange"
              color="#4CAF50"
            />
          </view>
          <text class="input-hint">å…è®¸åŠè·¯åŠ å…¥æˆ–æ›¿è¡¥å‚ä¸</text>
        </view>

        <!-- 6äººå’Œ7äººçš„ç‰¹æ®Šæ¨¡å¼é€‰æ‹© -->
        <view class="input-group" wx:if="{{formData.maxParticipants == 6}}">
          <text class="input-label">6äººè½¬æ¨¡å¼ *</text>
          <picker 
            mode="selector"
            range="{{sixPlayerModes}}"
            range-key="name"
            value="{{sixPlayerModeIndex}}"
            bindchange="onSixPlayerModeChange"
          >
            <view class="picker-view">
              {{sixPlayerModes[sixPlayerModeIndex].name}} - {{sixPlayerModes[sixPlayerModeIndex].description}}
            </view>
          </picker>
        </view>

        <view class="input-group" wx:if="{{formData.maxParticipants == 7}}">
          <text class="input-label">7äººè½¬æ¨¡å¼ *</text>
          <picker 
            mode="selector"
            range="{{sevenPlayerModes}}"
            range-key="name"
            value="{{sevenPlayerModeIndex}}"
            bindchange="onSevenPlayerModeChange"
          >
            <view class="picker-view">
              {{sevenPlayerModes[sevenPlayerModeIndex].name}} - {{sevenPlayerModes[sevenPlayerModeIndex].description}}
            </view>
          </picker>
        </view>

        <!-- è®©åˆ†è®¾ç½® -->
        <view class="input-group">
          <view class="switch-group">
            <text class="input-label">å¯ç”¨è®©åˆ†</text>
            <switch 
              checked="{{enableHandicap}}"
              bindchange="onHandicapChange"
              color="#4CAF50"
            />
          </view>
          <text class="input-hint">è€ƒè™‘ç”·å¥³åŠ›é‡å·®å¼‚ï¼Œè®¾ç½®è®©åˆ†è§„åˆ™</text>
        </view>

        <view class="input-group" wx:if="{{enableHandicap}}">
          <text class="input-label">è®©åˆ†è§„åˆ™</text>
          <picker 
            mode="selector"
            range="{{handicapTemplates}}"
            range-key="name"
            value="{{handicapTemplateIndex}}"
            bindchange="onHandicapTemplateChange"
          >
            <view class="picker-view">
              {{handicapTemplates[handicapTemplateIndex].name}} - {{handicapTemplates[handicapTemplateIndex].description}}
            </view>
          </picker>
        </view>
      </view>
    </view>

    <!-- æ´»åŠ¨è¯´æ˜ -->
    <view class="form-section card">
      <view class="section-title">æ´»åŠ¨è¯´æ˜</view>
      
      <view class="input-group">
        <textarea 
          class="textarea-field" 
          placeholder="è¯·è¾“å…¥æ´»åŠ¨è¯´æ˜ï¼ˆé€‰å¡«ï¼‰"
          value="{{formData.description}}"
          bindinput="onInput"
          data-field="description"
          maxlength="500"
        />
      </view>
    </view>

    <!-- æäº¤æŒ‰é’® -->
    <view class="submit-section">
      <button 
        class="btn-primary submit-btn" 
        bindtap="submitEvent"
        disabled="{{submitting}}"
        loading="{{submitting}}"
      >
        {{submitting ? 'å‘å¸ƒä¸­...' : 'å‘å¸ƒæ´»åŠ¨'}}
      </button>
    </view>
  </view>
</view>

